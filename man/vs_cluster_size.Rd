% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster_size.R
\name{vs_cluster_size}
\alias{vs_cluster_size}
\title{Clusterize FASTA sequences}
\usage{
vs_cluster_size(
  fasta_input,
  centroids = NULL,
  id = 0.97,
  strand = "plus",
  sizein = TRUE,
  sizeout = TRUE,
  relabel = "OTU",
  threads = 1,
  fasta_width = 0
)
}
\arguments{
\item{fasta_input}{a file with FASTA sequences or a FASTA object, see Details.}

\item{centroids}{file name for the FASTA file for output cluster centroid sequences. See Details.}

\item{id}{pairwise identity threshold for sequence to be added to cluster. See Details.}

\item{strand}{plus or both. When comparing sequences only check the plus strand or both strands.}

\item{sizein}{decides if abundance annotations present in sequence headers should be taken into account. True by default.}

\item{sizeout}{decides if abundance annotations should be added to FASTA headers.}

\item{relabel}{relabel sequences using the given prefix and a ticker to construct new headers.}

\item{threads}{number of computational threads to be used by vsearch.}

\item{fasta_width}{number of characters in the width of sequences in the output FASTA file. See Details.}
}
\value{
A tibble, \code{centroids_fasta}, with the centroid sequences in FASTA format. The tibble includes information about the clustering, including number of sequences, clusters, and singletons in addition to their min, max and average lengths and sizes.

The statistics from the clustering, \code{statistics}, is an attribute of \code{centroids_fasta}. This tibble contains filtering statistics, including number of kept and discarded sequences, and the names of the FASTQ files or objects that were filtered.
The statistics can be accessed by running \code{attributes(centroids_fasta)$statistics} or \code{attr(centroids_fasta, "statistics")}.
}
\description{
Clustering the FASTA sequences in the given file or object.
}
\details{
Sequences in the input file are clustered, using vsearchÂ´s cluster_size.
The function will automatically sort by decreasing sequence abundance beforehand.

\code{fasta_input} can either be a file with FASTA sequences or a FASTA object. The FASTA object needs to be a tibble
with columns \code{Header} and \code{Sequence}.

The centroids in \code{centroids} are the sequences that seeded the clusters (i.e. the first sequence of the cluster).
If \code{centroids} is specified, the remaining sequences after quality filtering are output to this file in FASTA-format.
If unspecified (\code{NULL}) the result is returned as a FASTA-object, i.e. a tibble with
columns \code{Header}, \code{centroid_size} and \code{Sequence}.

\code{id} is a value between 0 and 1, and describes the the minimum pairwise identity with the centroid for sequence to be added to cluster.
The sequence is not added if pairwise identity is bellow \code{id}. The pairwise identity is defined as the number of (matching columns) / (alignment length - terminal gaps).

FASTA files produced by vsearch are wrapped (sequences are written on lines of integer nucleotides).
\code{fasta_width} is by default set to zero to eliminate the wrapping.
}
\references{
\url{https://github.com/torognes/vsearch}
}
