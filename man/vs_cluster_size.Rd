% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vs_cluster_size.R
\name{vs_cluster_size}
\alias{vs_cluster_size}
\title{Cluster FASTA sequences}
\usage{
vs_cluster_size(
  fasta_input,
  centroids = NULL,
  id = 0.97,
  strand = "plus",
  sizein = TRUE,
  sizeout = TRUE,
  relabel = "OTU",
  threads = 1,
  fasta_width = 0
)
}
\arguments{
\item{fasta_input}{A FASTA file path or a FASTA object (tibble) with reads to cluster, see Details.}

\item{centroids}{Name of the FASTA output file for the cluster centroid sequences. If \code{NULL} no FASTA output file will be written to file. See Details.}

\item{id}{The pairwise identity threshold for sequence to be added to cluster. See Details.}

\item{strand}{\code{plus} or \code{both}. When comparing sequences only check the \code{plus} strand or \code{both} strands.}

\item{sizein}{Decides if abundance annotations present in sequence headers should be taken into account.}

\item{sizeout}{Decides if abundance annotations should be added to FASTA headers.}

\item{relabel}{Relabel sequences using the given prefix and a ticker to construct new headers.}

\item{threads}{The number of computational threads to be used by \code{vsearch}.}

\item{fasta_width}{The number of characters in the width of sequences in the output FASTA file. See Details.}
}
\value{
If \code{centroids} is not specified, a tibble containing the centroid sequences in FASTA format is returned. If \code{centroids} is specified nothing is returned.

When a FASTA object is returned, the statistics from the clustering, \code{statistics}, is an attribute of the centroids tibble (\code{centroids_fasta}).
This tibble contains clustering statistics, including statistics about input sequences, number of clusters and their sizes. The statistics can be accessed by running \code{attributes(centroids_fasta)$statistics} or \code{attr(centroids_fasta, "statistics")}.
}
\description{
Clustering the FASTA sequences in the given file or object.
}
\details{
Sequences in the input file are clustered, using \code{vsearch}Â´s \code{cluster_size}.
The function will automatically sort by decreasing sequence abundance beforehand.

\code{fasta_input} can either be a FASTA file or object. If provided as tibble, it must contain the columns \code{Header} and \code{Sequence}.

The centroids in \code{centroids} are the sequences that seeded the clusters (i.e. the first sequence of the cluster).
If \code{centroids} is specified, the remaining sequences after quality filtering are output to this file in FASTA-format.
If unspecified (\code{NULL}) the result is returned as a FASTA-object, i.e. a tibble with
columns \code{Header}, \code{centroid_size} and \code{Sequence}.

\code{id} is a value between 0 and 1, and describes the the minimum pairwise identity with the centroid for sequence to be added to cluster.
The sequence is not added if pairwise identity is bellow \code{id}. The pairwise identity is defined as the number of (matching columns) / (alignment length - terminal gaps).

FASTA files produced by \code{vsearch} are wrapped (sequences are written on lines of integer nucleotides).
\code{fasta_width} is by default set to zero to eliminate the wrapping.
}
\references{
\url{https://github.com/torognes/vsearch}
}
