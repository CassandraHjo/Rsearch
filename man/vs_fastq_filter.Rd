% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vs_fastq_filter.R
\name{vs_fastq_filter}
\alias{vs_fastq_filter}
\title{Quality filtering}
\usage{
vs_fastq_filter(
  fastq_input,
  reverse = NULL,
  output_format = "fasta",
  fastq_maxee_rate = 0.01,
  fastaout = NULL,
  fastqout = NULL,
  fastaout_rev = NULL,
  fastqout_rev = NULL,
  fasta_width = 0,
  minlen = 0,
  threads = 1,
  log_file = NULL
)
}
\arguments{
\item{fastq_input}{A FASTQ file path containing (forward) reads or a FASTQ object (tibble), see Details.}

\item{reverse}{An optional FASTQ file path containing reverse reads or a FASTQ object (tibble), see Details. If provided, it will be processed alongside \code{fastq_input}.}

\item{output_format}{Desired output format of tibble: \code{"fasta"} or \code{"fastq"}. Determines the format for both forward and reverse outputs.}

\item{fastq_maxee_rate}{Threshold for average expected error. Numeric value ranging form \code{0.0} to \code{1.0}. See Details.}

\item{fastaout}{Name of the FASTA output file for primary sequences (forward reads). If \code{NULL} no FASTA sequences will be written to file. See Details.}

\item{fastqout}{Name of the FASTQ output file for primary sequences (forward reads). If \code{NULL} no FASTQ sequences will be written to file. See Details.}

\item{fastaout_rev}{Name of the FASTA output file for reverse reads. If \code{NULL} no FASTA sequences will be written to file. See Details.}

\item{fastqout_rev}{Name of the FASTQ output file for reverse reads. If \code{NULL} no FASTQ sequences will be written to file. See Details.}

\item{fasta_width}{Number of characters per line in the output FASTA file. Only applies if the output file is in FASTA format. See Details.}

\item{minlen}{The minimum number of bases a sequence must have to be retained. Default is 0. See Details.}

\item{threads}{Number of computational threads to be used by \code{vsearch}.}

\item{log_file}{Name of the log file to capture messages from \code{vsearch}. If \code{NULL}, no log file is created.}
}
\value{
If output files are not specified, a tibble containing the filtered reads from \code{fastq_input} in the format specified by \code{output_format} is returned. If output files are specified, nothing is returned.

If \code{reverse} is specified, the resulting tibble (\code{filt_reverse}) containing the filtered reverse reads in the format specified by \code{output_format} is an attribute to the primary table (\code{filt_seqs}).
This table can be accessed by running \code{attributes(filt_seqs)$filt_reverse} or \code{attr(filt_seqs, "filt_reverse")}.

When a FASTA/FASTQ object is returned, the statistics from the filtering, \code{statistics}, is an attribute of the filtering tibble (\code{filt_seqs}).
This tibble contains filtering statistics, including number of kept and discarded sequences, and the names of the FASTQ files or objects that were filtered.
The statistics can be accessed by running \code{attributes(filt_seqs)$statistics} or \code{attr(filt_seqs, "statistics")}.
}
\description{
Quality filtering of FASTQ sequences.
}
\details{
The function filters sequences from the input FASTQ file or object based on the average expected error rate using \code{vsearch}.
If a \code{reverse} input is provided, it filters the reverse reads similarly. The output format for both primary and reverse sequences
is determined by the \code{output_format} parameter.

\code{fastq_input} and \code{reverse} can either be FASTQ files or FASTQ objects. If provided as tibbles, they must contain the columns \code{Header}, \code{Sequence}, and \code{Quality}.
\code{reverse} is an optional argument to the function. If provided, it will be processed alongside \code{fastq_input}, meaning the same \code{fastq_maxee_rate} will be used for both FASTQ objects.

If \code{fastaout}, \code{fastqout}, \code{fastaout_rev}, or \code{fastqout_rev} are specified, the remaining sequences after quality filtering are output to these files in either FASTA or FASTQ format.
If unspecified (\code{NULL}) no output is written to file. \code{output_format} has to match the desired output files.

Sequences with an average expected error greater than the specified \code{fastq_maxee_rate} are discarded.
For a given sequence, the average expected error is the sum of error probabilities for all the positions in the sequence, divided by the length of the sequence.

FASTA files produced by \code{vsearch} are wrapped (sequences are written on lines of integer nucleotides).
\code{fasta_width} is by default set to zero to eliminate the wrapping.

Any input sequence with fewer bases than the value set in \code{minlen} will be discarded. By default, \code{minlen} is set to 0, which means that no sequences are removed.
However, using the default value may allow empty sequences to remain in the results.
}
\references{
\url{https://github.com/torognes/vsearch}
}
