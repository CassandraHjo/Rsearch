% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vs_fastq_mergepairs.R
\name{vs_fastq_mergepairs}
\alias{vs_fastq_mergepairs}
\alias{vs_fastx_mergepairs}
\alias{vs_fasta_mergepairs}
\title{Merge paired-end sequence reads}
\usage{
vs_fastq_mergepairs(
  fastq_input,
  reverse,
  minovlen = 10,
  output_format = "fastq",
  fastaout = NULL,
  fastqout = NULL,
  fasta_width = 0,
  minlen = 0,
  log_file = NULL,
  threads = 1
)
}
\arguments{
\item{fastq_input}{A FASTQ file path or object containing (forward) reads. See Details.}

\item{reverse}{A FASTQ file path or object containing (reverse) reads See Details.}

\item{minovlen}{The minimum overlap between the merged reads. Must be at least 5.
Defaults to \code{10}.}

\item{output_format}{Desired output format of file or tibble: \code{"fasta"}
or \code{"fastq"} (default).}

\item{fastaout}{Name of the FASTA output file with the merged reads.
If \code{NULL} (default) no output will be written to file. See Details.}

\item{fastqout}{Name of the FASTQ output file with the merged reads.
If \code{NULL} (default) no output will be written to file. See Details.}

\item{fasta_width}{Number of characters per line in the output FASTA file.
Only applies if the output file is in FASTA format. Defaults to \code{0}. See Details.}

\item{minlen}{The minimum number of bases a sequence must have to be retained.
Defaults to \code{0}. See Details.}

\item{log_file}{Name of the log file to capture messages from \code{vsearch}.
If \code{NULL}, no log file is created. Defaults to \code{NULL}.}

\item{threads}{Number of computational threads to be used by \code{vsearch}.
Defaults to \code{1}.}
}
\value{
Tibble or \code{NULL}.

If output files are not specified, a tibble containing the merged reads in the
format specified by \code{output_format} is returned. If an output file is
specified, results are written to file and nothing is returned.

When a FASTA/FASTQ object is returned, the statistics from the merging,
\code{statistics}, is an attribute of the merging tibble (\code{merged_seqs}).
This tibble contains merging statistics, including number of pairs, number
of merged pairs, and length metrics. The statistics can be accessed by
running \code{attributes(merged_seqs)$statistics} or
\code{attr(merged_seqs, "statistics")}.
}
\description{
Merges paired-end sequence reads with overlapping regions into one sequence.
}
\details{
The read-pairs in the input FASTQ-files (\code{fastq_input} and
\code{reverse}) are merged if they have sufficient overlap, using \code{vsearch}.

\code{fastq_input} and \code{reverse} can either be FASTQ files or FASTQ
objects. FASTQ objects are tibbles that contain the columns \code{Header},
\code{Sequence}, and \code{Quality}.
Forward and reverse reads must appear in the same order and total number in
both files.

If \code{fastaout} or \code{fastqout} is specified, the merged reads are
output to this file in either FASTA or FASTQ format.
If unspecified (\code{NULL}) the results are returned as a FASTA or FASTQ
object, and no output is written to file. \code{output_format} has to match
the desired output files/objects.

FASTA files produced by \code{vsearch} are wrapped (sequences are written on
lines of integer nucleotides).
\code{fasta_width} is by default set to zero to eliminate the wrapping.

Any input sequence with fewer bases than the value set in \code{minlen} will
be discarded. By default, \code{minlen} is set to 0, which means that no
sequences are removed.
However, using the default value may allow empty sequences to remain in
the results.

If \code{log_file} is specified, the messages and merging statistics are output to this file.
If unspecified (\code{NULL}) no log file is written. If \code{fastqout} is specified,
then \code{log_file} needs to be specified in order to get the merging statistics from \code{vsearch}.
}
\examples{
\dontrun{
# Read example FASTQ files
fastq_input <- file.path(file.path(path.package("Rsearch"), "extdata"), "R1_sample1_small.fq")
reverse <- file.path(file.path(path.package("Rsearch"), "extdata"), "R2_sample1_small.fq")

# Define other arguments
output_format <- "fastq"

# Execute merging, with tibble as output
merge_seqs <- vs_fastq_mergepairs(fastq_input = fastq_input,
                                  reverse = reverse,
                                  output_format = output_format)

# Extract merging statistics
statistics <- attr(merge_seqs, "statistics")
}

}
\references{
\url{https://github.com/torognes/vsearch}
}
